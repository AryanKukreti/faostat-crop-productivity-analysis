# Markdown
### **FAOSTAT Crop Production**

This project uses global agricultural production data sourced from the FAOSTAT (Food and Agriculture Organization of the United Nations) database.
The original dataset contains annual production statistics for over 240 countries, 300+ crops, and 20+ agricultural elements, spanning the years 1961â€“2023.

The raw FAOSTAT files were provided in a wide format, where each year appeared as a separate column (e.g., Y1961, Y1962, â€¦, Y2023).
To prepare the data for time-series analysis and modeling, the dataset was reshaped into a long/tidy format.

# Output
C:\Users\acer\AppData\Local\Temp\ipykernel_11560\3130314297.py:1: DtypeWarning:

Columns (13) have mixed types. Specify dtype option on import or set low_memory=False.


Area Code Area Code (M49)         Area  Item Code Item Code (CPC)  \
0          2            '004  Afghanistan        221          '01371   
1          2            '004  Afghanistan        221          '01371   
2          2            '004  Afghanistan        221          '01371   
3          2            '004  Afghanistan        221          '01371   
4          2            '004  Afghanistan        221          '01371   

                Item  Element Code         Element  Year Code  Year Unit  \
0  Almonds, in shell          5312  Area harvested       1961  1961   ha   
1  Almonds, in shell          5312  Area harvested       1962  1962   ha   
2  Almonds, in shell          5312  Area harvested       1963  1963   ha   
3  Almonds, in shell          5312  Area harvested       1964  1964   ha   
4  Almonds, in shell          5312  Area harvested       1965  1965   ha   

   Value Flag Note  
0    0.0    A  NaN  
1    0.0    A  NaN  
2    0.0    A  NaN  
3    0.0    A  NaN  
4    0.0    A  NaN

# Output

Columns after dropping 'Note':
['Area Code', 'Area Code (M49)', 'Area', 'Item Code', 'Item Code (CPC)', 'Item', 'Element Code', 'Element', 'Year Code', 'Year', 'Unit', 'Value', 'Flag']

Area Code Area Code (M49)         Area  Item Code Item Code (CPC)  \
0          2            '004  Afghanistan        221          '01371   
1          2            '004  Afghanistan        221          '01371   
2          2            '004  Afghanistan        221          '01371   
3          2            '004  Afghanistan        221          '01371   
4          2            '004  Afghanistan        221          '01371   

                Item  Element Code         Element  Year Code  Year Unit  \
0  Almonds, in shell          5312  Area harvested       1961  1961   ha   
1  Almonds, in shell          5312  Area harvested       1962  1962   ha   
2  Almonds, in shell          5312  Area harvested       1963  1963   ha   
3  Almonds, in shell          5312  Area harvested       1964  1964   ha   
4  Almonds, in shell          5312  Area harvested       1965  1965   ha   

   Value Flag  
0    0.0    A  
1    0.0    A  
2    0.0    A  
3    0.0    A  
4    0.0    A

# Markdown
## **EXPLOATORY DATA ANALYSIS**

# Output
Unique Element types: 8
Elements:
- Area harvested
- Laying
- Milk Animals
- Producing Animals/Slaughtered
- Production
- Stocks
- Yield
- Yield/Carcass Weight


# Output
Elements frequency in decreasing order:
Element
Production                       1645089
Area harvested                    905599
Yield                             825396
Producing Animals/Slaughtered     311410
Stocks                            179249
Yield/Carcass Weight              172950
Milk Animals                       45845
Laying                             30714
Name: count, dtype: int64


# Markdown
*Found 8 different Element types in the dataset.

*Only 3 of them relate to crop productivity: Production, Area harvested, Yield.

*Other elements belong to livestock or inventory data.

For our business goal (global crop yield trends), only the three crop-related Elements are required. These will be used to build the analysis-ready metrics dataset.

# Output
New shape after filtering to crop elements: (3376084, 13)

Remaining elements:
Element
Production        1645089
Area harvested     905599
Yield              825396
Name: count, dtype: int64


# Output
Year range: 1961 to 2023

Year counts (top 10 years):
Year
1961    48427
1962    48437
1963    48436
1964    48450
1965    48446
1966    48495
1967    48501
1968    48530
1969    48529
1970    48579
1971    48598
1972    48613
1973    48615
1974    48645
1975    48693
1976    48723
1977    48789
1978    48804
1979    48866
1980    48991
Name: count, dtype: int64

Number of rows per year (full sorted):
Year
1961    48427
1962    48437
1963    48436
1964    48450
1965    48446
        ...  
2019    58439
2020    58566
2021    58702
2022    58812
2023    53872
Name: count, Length: 63, dtype: int64


# Markdown
- The dataset spans **1961 to 2023**, providing 63 years of historical agricultural data.
- Row counts gradually increase over time, reflecting improvements in global reporting coverage.
- Recent years (especially 2023) have slightly lower counts due to FAOSTAT reporting delays.
- Overall, the year coverage is consistent and well-suited for long-term trend analysis.

# Output
                  Value
Element                
Area harvested   832999
Production      1572469
Yield            825396

Missing values per Element:
Element
Production        72620
Area harvested    72600
Name: count, dtype: int64


# Markdown
FAOSTAT reports each agricultural indicator independently, and Yield is published only when both Production and Area harvested are available. Since Yield is defined as:

    **Yield = Production Ã· Area harvested**

FAOSTAT does not generate Yield values for years or crops where either input is missing. As a result, missing values in Production or Area harvested are common and **reflect genuine reporting gaps by national statistical offices, not data errors.**

Because this missingness is structurally meaningful and expected in FAOSTAT datasets, we do not impute or alter missing values at this stage. Missingness will be evaluated only after constructing the analysis-ready dataset (Area Ã— Item Ã— Year), where its impact on trend analysis can be more clearly assessed.

# Output
Shape of metrics_df: (1555222, 8)

Columns: ['Area', 'Area Code (M49)', 'Item', 'Item Code', 'Year', 'area_harvested', 'production', 'yield']

Sample rows:

Area Area Code (M49)  \
1211114                          Slovenia            '705   
383819   Democratic Republic of the Congo            '180   
1553013                          Zimbabwe            '716   
631449                            Hungary            '348   
898626                      Middle Africa            '017   
1521323                             World            '001   
1329195                          Suriname            '740   
1541611                      Yugoslav SFR            '890   
462272                              Egypt            '818   
1355856                        Tajikistan            '762   
1373153                              Togo            '768   
267412                       Central Asia            '143   
251586                    Central America            '013   
804553                          Lithuania            '440   
1346801              Syrian Arab Republic            '760   
1152436                            Rwanda            '646   
822620                         Luxembourg            '442   
81685                                Asia            '142   
1412278                            Uganda            '800   
1050674                          Pakistan            '586   

                                                    Item  Item Code  Year  \
1211114                Meat of turkeys, fresh or chilled       1080  2005   
383819   Edible offal of sheep, fresh, chilled or frozen        978  2005   
1553013                               Green corn (maize)        446  2021   
631449                            Cucumbers and gherkins        397  2019   
898626                                        Sisal, raw        789  1968   
1521323                                   Cassava, fresh        125  2006   
1329195                                          Bananas        486  1991   
1541611                                              Rye         71  1966   
462272                         Sunflower-seed oil, crude        268  2011   
1355856                               Rape or colza seed        270  2022   
1373153                                     Palm kernels        256  1966   
267412                                     Sour cherries        530  1997   
251586                          Hen eggs in shell, fresh       1062  1971   
804553                   Meat of geese, fresh or chilled       1073  2010   
1346801                                           Millet         79  2012   
1152436                         Hen eggs in shell, fresh       1062  1999   
822620                                Rape or colza seed        270  2018   
81685                                        Ginger, raw        720  1997   
1412278                              Cotton lint, ginned        767  1996   
1050674                                Almonds, in shell        221  2005   

         area_harvested    production    yield  
1211114             NaN  9.215000e+03      NaN  
383819              NaN  5.617700e+02      NaN  
1553013          1789.0  4.344320e+03   2428.8  
631449            650.0  2.668000e+04  41046.2  
898626          51300.0  6.660000e+04   1298.2  
1521323      18846360.0  2.236281e+08  11865.9  
1329195          2116.0  4.997100e+04  23615.8  
1541611        141000.0  1.760000e+05   1248.2  
462272              NaN  3.040000e+04      NaN  
1355856           140.0  1.163700e+02    831.2  
1373153             NaN  1.700000e+04      NaN  
267412           1023.0  3.620450e+03   3537.6  
251586              NaN  4.503710e+05    229.0  
804553              NaN  6.600000e+01      NaN  
1346801           253.0  4.770000e+02   1885.4  
1152436             NaN  2.100000e+03     80.0  
822620           3390.0  1.118000e+04   3297.9  
81685          130581.0  7.679396e+05   5880.9  
1412278             NaN  1.741800e+04      NaN  
1050674         10277.0  2.312900e+04   2250.6

# Markdown
Now we do work upon the missingness of the data

# Output
Area                    0
Area Code (M49)         0
Item                    0
Item Code               0
Year                    0
area_harvested     722223
production            428
yield              729826
dtype: int64

Summary of zero values:
area_harvested    23552
production        45411
dtype: int64


# Markdown
### Missingness & Zero-Value Patterns

- No missing values in core identifiers (Area, Item, Year), confirming grain integrity.
- Yield has ~730k missing values, reflecting FAOSTAT's rule of publishing Yield only when both Production and Area harvested are available.
- Area harvested shows substantial missingness (~722k), typical due to incomplete land-use reporting for many crops/countries.
- Production has very few missing values (~428), indicating strong reporting coverage.
- Zero values in production and area harvested represent genuine non-production years and are kept as valid observations.

# Markdown
To conduct reliable trend analysis, we must first identify key data-quality cases in the dataset.

#### 1. **Production > 0 but `area_harvested` is missing**
FAOSTAT sometimes reports or estimates production even when the harvested area is unavailable.  
This case helps flag **partial data** that may require manual yield reconstruction.

####  2. **`area_harvested` > 0 but production is missing**
Although rare, this situation can indicate **broken or inconsistent reporting**.  
These rows usually need to be excluded or investigated further.

####  3. **Both production and area are zero**
This represents a **true non-production** scenarioâ€”e.g., crop not grown in that year or region.

###  These Patterns can help us understand

- Which rows are **valid for trend analysis**
- Which **countries/crops show unreliable reporting**
- Whether **yield could be recomputed** manually at a later stage

# Output
Case 1 count (production > 0 but area missing): 698396
Case 2 count (area > 0 but production missing): 324
Case 3 count (both zero): 21370


# Output
Area Area Code (M49)               Item  Item Code  Year  \
0  Afghanistan            '004  Almonds, in shell        221  1961   
1  Afghanistan            '004  Almonds, in shell        221  1962   
2  Afghanistan            '004  Almonds, in shell        221  1963   
3  Afghanistan            '004  Almonds, in shell        221  1964   
4  Afghanistan            '004  Almonds, in shell        221  1965   

   area_harvested  production  yield  
0             0.0         0.0    NaN  
1             0.0         0.0    NaN  
2             0.0         0.0    NaN  
3             0.0         0.0    NaN  
4             0.0         0.0    NaN

# Output
<Figure size 1400x800 with 2 Axes>

# Markdown
### Area-Level Data Coverage

- Many countries and regions have **full 63-year coverage** (1961â€“2023), making them ideal candidates for long-term trend and yield analysis.
- These include Afghanistan, Nepal, Netherlands, New Zealand, Nigeria, and several regional aggregates.
- Countries with limited coverage (12â€“20 years) include South Sudan, Serbia and Montenegro, and Sudanâ€”mainly due to geopolitical changes or recent independence.
- Full-coverage areas will be prioritized for spatiotemporal trend analysis, while short-coverage areas will be analyzed separately or limited to recent periods.

# Markdown
check coverage by crop (Item).

# Output
Top 20 Items by year coverage:
Item
Abaca, manila hemp, raw                                                     63
Other stone fruits                                                          63
Onions and shallots, dry (excluding dehydrated)                             63
Onions and shallots, green                                                  63
Oranges                                                                     63
Other beans, green                                                          63
Other berries and fruits of the genus vaccinium n.e.c.                      63
Other citrus fruit, n.e.c.                                                  63
Other fibre crops, raw, n.e.c.                                              63
Other fruits, n.e.c.                                                        63
Other meat of mammals, fresh or chilled                                     63
Other nuts (excluding wild edible nuts and groundnuts), in shell, n.e.c.    63
Other oil seeds, n.e.c.                                                     63
Other pulses n.e.c.                                                         63
Other stimulant, spice and aromatic crops, n.e.c.                           63
Other sugar crops n.e.c.                                                    63
Okra                                                                        63
Other tropical fruits, n.e.c.                                               63
Other vegetables, fresh n.e.c.                                              63
Papayas                                                                     63
Name: Year, dtype: int64

Bottom 20 Items by year coverage:
Item
Cheese from milk of sheep, fresh or processed                                                                                       62
Skim milk and whey powder                                                                                                           62
Skim Milk & Buttermilk, Dry                                                                                                         62
Safflower-seed oil, crude                                                                                                           62
Cheese (All Kinds)                                                                                                                  62
Raw silk (not thrown)                                                                                                               62
Cheese from milk of buffalo, fresh or processed                                                                                     62
Cotton lint, ginned                                                                                                                 62
Cheese from milk of goats, fresh or processed                                                                                       62
Cheese from skimmed cow milk                                                                                                        62
Cheese from whole cow milk                                                                                                          62
Raw cane or beet sugar (centrifugal only)                                                                                           62
Rapeseed or canola oil, crude                                                                                                       62
Coconut oil                                                                                                                         62
Yoghurt                                                                                                                             62
Jojoba seeds                                                                                                                        42
Balata, gutta-percha, guayule, chicle and similar natural gums in primary forms or in plates, sheets or strip                       30
Other pome fruits                                                                                                                   24
Green tea (not fermented), black tea (fermented) and partly fermented tea, in immediate packings of a content not exceeding 3 kg    13
Cassava leaves                                                                                                                       1
Name: Year, dtype: int64


# Output
Current label: Almonds, in shell
Current label: Anise, badian, coriander, cumin, caraway, fennel and juniper berries, raw
Current label: Apples
Current label: Apricots
Current label: Barley
Current label: Beef and Buffalo Meat, primary
Current label: Butter and Ghee
Current label: Butter and ghee of sheep milk
Current label: Butter of cow milk
Current label: Buttermilk, dry
Current label: Cantaloupes and other melons
Current label: Cattle fat, unrendered
Current label: Cereals, primary
Current label: Cheese (All Kinds)
Current label: Cheese from milk of goats, fresh or processed
Current label: Cheese from milk of sheep, fresh or processed
Current label: Citrus Fruit, Total
Current label: Cotton lint, ginned
Current label: Cotton seed
Current label: Cottonseed oil
Current label: Edible offal of cattle, fresh, chilled or frozen
Current label: Edible offal of goat, fresh, chilled or frozen
Current label: Edible offal of sheep, fresh, chilled or frozen
Current label: Edible offals of camels and other camelids, fresh, chilled or frozen
Current label: Eggs Primary
Current label: Fat of camels
Current label: Fibre Crops, Fibre Equivalent
Current label: Figs
Current label: Fruit Primary
Current label: Game meat, fresh, chilled or frozen
Current label: Goat fat, unrendered
Current label: Grapes
Current label: Hen eggs in shell, fresh
Current label: Linseed
Current label: Maize (corn)
Current label: Meat of camels, fresh or chilled
Current label: Meat of cattle with the bone, fresh or chilled
Current label: Meat of chickens, fresh or chilled
Current label: Meat of goat, fresh or chilled
Current label: Meat of sheep, fresh or chilled
Current label: Meat, Poultry
Current label: Meat, Total
Current label: Milk, Total
Current label: Millet
Current label: Molasses
Current label: Mustard seed
Current label: Natural honey
Current label: Oil of linseed
Current label: Oil of sesame seed
Current label: Oilcrops, Cake Equivalent
Current label: Oilcrops, Oil Equivalent
Current label: Olive oil
Current label: Olives
Current label: Onions and shallots, dry (excluding dehydrated)
Current label: Oranges
Current label: Other berries and fruits of the genus vaccinium n.e.c.
Current label: Other citrus fruit, n.e.c.
Current label: Other fruits, n.e.c.
Current label: Other nuts (excluding wild edible nuts and groundnuts), in shell, n.e.c.
Current label: Other pulses n.e.c.
Current label: Other stimulant, spice and aromatic crops, n.e.c.
Current label: Other stone fruits
Current label: Other vegetables, fresh n.e.c.
Current label: Peaches and nectarines
Current label: Pears
Current label: Pistachios, in shell
Current label: Plums and sloes
Current label: Potatoes
Current label: Pulses, Total
Current label: Raw cane or beet sugar (centrifugal only)
Current label: Raw hides and skins of cattle
Current label: Raw hides and skins of goats or kids
Current label: Raw hides and skins of sheep or lambs
Current label: Raw milk of camel
Current label: Raw milk of cattle
Current label: Raw milk of goats
Current label: Raw milk of sheep
Current label: Raw silk (not thrown)
Current label: Rice
Current label: Roots and Tubers, Total
Current label: Seed cotton, unginned
Current label: Sesame seed
Current label: Sheep and Goat Meat
Current label: Sheep fat, unrendered
Current label: Shorn wool, greasy, including fleece-washed shorn wool
Current label: Silk-worm cocoons suitable for reeling
Current label: Skim Milk & Buttermilk, Dry
Current label: Skim milk of cows
Current label: Soya beans
Current label: Sugar Crops Primary
Current label: Sugar beet
Current label: Sugar cane
Current label: Sunflower seed
Current label: Sunflower-seed oil, crude
Current label: Treenuts, Total
Current label: Vegetables Primary
Current label: Walnuts, in shell
Current label: Watermelons
Current label: Wheat
Current label: Abaca, manila hemp, raw
Current label: Areca nuts
Current label: Artichokes
Current label: Asparagus
Current label: Avocados
Current label: Bambara beans, dry
Current label: Bananas
Current label: Beans, dry
Current label: Beer of barley, malted
Current label: Beeswax
Current label: Blueberries
Current label: Brazil nuts, in shell
Current label: Broad beans and horse beans, dry
Current label: Broad beans and horse beans, green
Current label: Buckwheat
Current label: Buffalo fat, unrendered
Current label: Butter of buffalo milk
Current label: Cabbages
Current label: Canary seed
Current label: Carrots and turnips
Current label: Cashew nuts, in shell
Current label: Cashewapple
Current label: Cassava leaves
Current label: Cassava, fresh
Current label: Castor oil seeds
Current label: Cauliflowers and broccoli
Current label: Cereals n.e.c.
Current label: Cheese from milk of buffalo, fresh or processed
Current label: Cheese from skimmed cow milk
Current label: Cheese from whole cow milk
Current label: Cherries
Current label: Chestnuts, in shell
Current label: Chick peas, dry
Current label: Chicory roots
Current label: Chillies and peppers, dry (Capsicum spp., Pimenta spp.), raw
Current label: Chillies and peppers, green (Capsicum spp. and Pimenta spp.)
Current label: Cinnamon and cinnamon-tree flowers, raw
Current label: Cloves (whole stems), raw
Current label: Cocoa beans
Current label: Coconut oil
Current label: Coconuts, in shell
Current label: Coffee, green
Current label: Coir, raw
Current label: Cow peas, dry
Current label: Cranberries
Current label: Cream, fresh
Current label: Cucumbers and gherkins
Current label: Currants
Current label: Dates
Current label: Edible offal of buffalo, fresh, chilled or frozen
Current label: Edible offal of pigs, fresh, chilled or frozen
Current label: Edible offals of horses and other equines,  fresh, chilled or frozen
Current label: Edible roots and tubers with high starch or inulin content, n.e.c., fresh
Current label: Eggplants (aubergines)
Current label: Eggs from other birds in shell, fresh, n.e.c.
Current label: Evaporated & Condensed Milk
Current label: Fat of pigs
Current label: Flax, raw or retted
Current label: Fonio
Current label: Ghee from cow milk
Current label: Ginger, raw
Current label: Green corn (maize)
Current label: Green garlic
Current label: Green tea (not fermented), black tea (fermented) and partly fermented tea, in immediate packings of a content not exceeding 3 kg
Current label: Groundnut oil
Current label: Groundnuts, excluding shelled
Current label: Hazelnuts, in shell
Current label: Hop cones
Current label: Horse meat, fresh or chilled
Current label: Jute, raw or retted
Current label: Karite nuts (sheanuts)
Current label: Kenaf, and other textile bast fibres, raw or retted
Current label: Kiwi fruit
Current label: Kola nuts
Current label: Leeks and other alliaceous vegetables
Current label: Lemons and limes
Current label: Lentils, dry
Current label: Lettuce and chicory
Current label: Locust beans (carobs)
Current label: Lupins
Current label: Mangoes, guavas and mangosteens
Current label: Margarine and shortening
Current label: Meat of asses, fresh or chilled
Current label: Meat of buffalo, fresh or chilled
Current label: Meat of ducks, fresh or chilled
Current label: Meat of geese, fresh or chilled
Current label: Meat of pig with the bone, fresh or chilled
Current label: Meat of pigeons and other birds n.e.c., fresh, chilled or frozen
Current label: Meat of rabbits and hares, fresh or chilled
Current label: Meat of turkeys, fresh or chilled
Current label: Melonseed
Current label: Mushrooms and truffles
Current label: Natural rubber in primary forms
Current label: Nutmeg, mace, cardamoms, raw
Current label: Oats
Current label: Oil of maize
Current label: Oil of palm kernel
Current label: Oil palm fruit
Current label: Okra
Current label: Onions and shallots, green
Current label: Other beans, green
Current label: Other fibre crops, raw, n.e.c.
Current label: Other meat of mammals, fresh or chilled
Current label: Other oil seeds, n.e.c.
Current label: Other tropical fruits, n.e.c.
Current label: Palm kernels
Current label: Palm oil
Current label: Papayas
Current label: Peas, dry
Current label: Peas, green
Current label: Pepper (Piper spp.), raw
Current label: Peppermint, spearmint
Current label: Pig fat, rendered
Current label: Pigeon peas, dry
Current label: Pineapples
Current label: Plantains and cooking bananas
Current label: Pomelos and grapefruits
Current label: Pumpkins, squash and gourds
Current label: Pyrethrum, dried flowers
Current label: Quinces
Current label: Rape or colza seed
Current label: Rapeseed or canola oil, crude
Current label: Raspberries
Current label: Raw hides and skins of buffaloes
Current label: Raw milk of buffalo
Current label: Rye
Current label: Safflower seed
Current label: Safflower-seed oil, crude
Current label: Sisal, raw
Current label: Skim milk and whey powder
Current label: Skim milk, evaporated
Current label: Snails, fresh, chilled, frozen, dried, salted or in brine, except sea snails
Current label: Sorghum
Current label: Soya bean oil
Current label: Spinach
Current label: Strawberries
Current label: String beans
Current label: Sweet potatoes
Current label: Tallow
Current label: Tangerines, mandarins, clementines
Current label: Taro
Current label: Tea leaves
Current label: Tomatoes
Current label: Triticale
Current label: Tung nuts
Current label: Unmanufactured tobacco
Current label: Vanilla, raw
Current label: Vetches
Current label: Whey, dry
Current label: Whole milk powder
Current label: Whole milk, condensed
Current label: Whole milk, evaporated
Current label: Wine
Current label: Yams
Current label: Yoghurt
Current label: Sour cherries
Current label: Agave fibres, raw, n.e.c.
Current label: Balata, gutta-percha, guayule, chicle and similar natural gums in primary forms or in plates, sheets or strip
Current label: Hempseed
Current label: Jojoba seeds
Current label: MatÃ© leaves
Current label: Meat of mules, fresh or chilled
Current label: Meat of other domestic camelids, fresh or chilled
Current label: Meat of other domestic rodents, fresh or chilled
Current label: Mixed grain
Current label: Persimmons
Current label: Quinoa
Current label: Ramie, raw or retted
Current label: Skim milk, condensed
Current label: True hemp, raw or retted
Current label: Whey, condensed
Current label: Yautia
Current label: Ghee from buffalo milk
Current label: Gooseberries
Current label: Kapok fibre, raw
Current label: Kapok fruit
Current label: Kapokseed in shell
Current label: Other pome fruits
Current label: Other sugar crops n.e.c.
Current label: Poppy seed
Current label: Tallowtree seeds


# Output
[Error] KeyError: 'Item_cleaned'
[31m---------------------------------------------------------------------------[39m
[31mKeyError[39m                                  Traceback (most recent call last)
[36mCell[39m[36m [39m[32mIn[234][39m[32m, line 2[39m
[32m      1[39m [38;5;66;03m# Coverage check: number of years per crop (Item)[39;00m
[32m----> [39m[32m2[39m item_coverage = [43mmetrics_df[49m[43m.[49m[43mgroupby[49m[43m([49m[33;43m'[39;49m[33;43mItem_cleaned[39;49m[33;43m'[39;49m[43m)[49m[[33m'[39m[33mYear[39m[33m'[39m].nunique().sort_values(ascending=[38;5;28;01mFalse[39;00m)
[32m      4[39m [38;5;28mprint[39m([33m"[39m[33mTop 20 Items by year coverage:[39m[33m"[39m)
[32m      5[39m [38;5;28mprint[39m(item_coverage.head([32m20[39m))

[36mFile [39m[32mc:\Users\acer\miniconda3\envs\env\Lib\site-packages\pandas\core\frame.py:9210[39m, in [36mDataFrame.groupby[39m[34m(self, by, axis, level, as_index, sort, group_keys, observed, dropna)[39m
[32m   9207[39m [38;5;28;01mif[39;00m level [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m [38;5;129;01mand[39;00m by [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m:
[32m   9208[39m     [38;5;28;01mraise[39;00m [38;5;167;01mTypeError[39;00m([33m"[39m[33mYou have to supply one of [39m[33m'[39m[33mby[39m[33m'[39m[33m and [39m[33m'[39m[33mlevel[39m[33m'[39m[33m"[39m)
[32m-> [39m[32m9210[39m [38;5;28;01mreturn[39;00m [43mDataFrameGroupBy[49m[43m([49m
[32m   9211[39m [43m    [49m[43mobj[49m[43m=[49m[38;5;28;43mself[39;49m[43m,[49m
[32m   9212[39m [43m    [49m[43mkeys[49m[43m=[49m[43mby[49m[43m,[49m
[32m   9213[39m [43m    [49m[43maxis[49m[43m=[49m[43maxis[49m[43m,[49m
[32m   9214[39m [43m    [49m[43mlevel[49m[43m=[49m[43mlevel[49m[43m,[49m
[32m   9215[39m [43m    [49m[43mas_index[49m[43m=[49m[43mas_index[49m[43m,[49m
[32m   9216[39m [43m    [49m[43msort[49m[43m=[49m[43msort[49m[43m,[49m
[32m   9217[39m [43m    [49m[43mgroup_keys[49m[43m=[49m[43mgroup_keys[49m[43m,[49m
[32m   9218[39m [43m    [49m[43mobserved[49m[43m=[49m[43mobserved[49m[43m,[49m
[32m   9219[39m [43m    [49m[43mdropna[49m[43m=[49m[43mdropna[49m[43m,[49m
[32m   9220[39m [43m[49m[43m)[49m

[36mFile [39m[32mc:\Users\acer\miniconda3\envs\env\Lib\site-packages\pandas\core\groupby\groupby.py:1331[39m, in [36mGroupBy.__init__[39m[34m(self, obj, keys, axis, level, grouper, exclusions, selection, as_index, sort, group_keys, observed, dropna)[39m
[32m   1328[39m [38;5;28mself[39m.dropna = dropna
[32m   1330[39m [38;5;28;01mif[39;00m grouper [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m:
[32m-> [39m[32m1331[39m     grouper, exclusions, obj = [43mget_grouper[49m[43m([49m
[32m   1332[39m [43m        [49m[43mobj[49m[43m,[49m
[32m   1333[39m [43m        [49m[43mkeys[49m[43m,[49m
[32m   1334[39m [43m        [49m[43maxis[49m[43m=[49m[43maxis[49m[43m,[49m
[32m   1335[39m [43m        [49m[43mlevel[49m[43m=[49m[43mlevel[49m[43m,[49m
[32m   1336[39m [43m        [49m[43msort[49m[43m=[49m[43msort[49m[43m,[49m
[32m   1337[39m [43m        [49m[43mobserved[49m[43m=[49m[38;5;28;43;01mFalse[39;49;00m[43m [49m[38;5;28;43;01mif[39;49;00m[43m [49m[43mobserved[49m[43m [49m[38;5;129;43;01mis[39;49;00m[43m [49m[43mlib[49m[43m.[49m[43mno_default[49m[43m [49m[38;5;28;43;01melse[39;49;00m[43m [49m[43mobserved[49m[43m,[49m
[32m   1338[39m [43m        [49m[43mdropna[49m[43m=[49m[38;5;28;43mself[39;49m[43m.[49m[43mdropna[49m[43m,[49m
[32m   1339[39m [43m    [49m[43m)[49m
[32m   1341[39m [38;5;28;01mif[39;00m observed [38;5;129;01mis[39;00m lib.no_default:
[32m   1342[39m     [38;5;28;01mif[39;00m [38;5;28many[39m(ping._passed_categorical [38;5;28;01mfor[39;00m ping [38;5;129;01min[39;00m grouper.groupings):

[36mFile [39m[32mc:\Users\acer\miniconda3\envs\env\Lib\site-packages\pandas\core\groupby\grouper.py:1043[39m, in [36mget_grouper[39m[34m(obj, key, axis, level, sort, observed, validate, dropna)[39m
[32m   1041[39m         in_axis, level, gpr = [38;5;28;01mFalse[39;00m, gpr, [38;5;28;01mNone[39;00m
[32m   1042[39m     [38;5;28;01melse[39;00m:
[32m-> [39m[32m1043[39m         [38;5;28;01mraise[39;00m [38;5;167;01mKeyError[39;00m(gpr)
[32m   1044[39m [38;5;28;01melif[39;00m [38;5;28misinstance[39m(gpr, Grouper) [38;5;129;01mand[39;00m gpr.key [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m:
[32m   1045[39m     [38;5;66;03m# Add key to exclusions[39;00m
[32m   1046[39m     exclusions.add(gpr.key)

[31mKeyError[39m: 'Item_cleaned'

# Output
Area Area Code (M49)               Item  Item Code  Year  \
0  Afghanistan            '004  Almonds, in shell        221  1961   
1  Afghanistan            '004  Almonds, in shell        221  1962   
2  Afghanistan            '004  Almonds, in shell        221  1963   
3  Afghanistan            '004  Almonds, in shell        221  1964   
4  Afghanistan            '004  Almonds, in shell        221  1965   

   area_harvested  production  yield Item_clean  
0             0.0         0.0    NaN    Almonds  
1             0.0         0.0    NaN    Almonds  
2             0.0         0.0    NaN    Almonds  
3             0.0         0.0    NaN    Almonds  
4             0.0         0.0    NaN    Almonds

# Output
Top 20 Items by year coverage:
Item_clean
Abaca Manila Hemp                                         63
Oats                                                      63
Oilcrops (Cake)                                           63
Oilcrops (Oil)                                            63
Okra                                                      63
Olives                                                    63
Onions And Shallots                                       63
Onions And Shallots (Excluding Dehydrated)                63
Oranges                                                   63
Other Beans                                               63
Other Berries And Fruits Of The Genus Vaccinium           63
Other Citrus Fruit                                        63
Other Fibre Crops                                         63
Other Fruits                                              63
Other Meat Of Mammals                                     63
Other Nuts (Excluding Wild Edible Nuts And Groundnuts)    63
Other Oil Seeds                                           63
Other Pulses                                              63
Other Stimulant Spice And Aromatic Crops                  63
Other Stone Fruits                                        63
Name: Year, dtype: int64

Bottom 20 Items by year coverage:
Item_clean
Ghee From Cow Milk                                                                                       62
Sesame Seed Oil                                                                                          62
Yoghurt                                                                                                  62
Molasses                                                                                                 62
Cane Or Beet Sugar ()                                                                                    62
Buttermilk                                                                                               62
Groundnut Oil                                                                                            62
Soya Bean Oil                                                                                            62
Coconut Oil                                                                                              62
Skim Milk & Buttermilk                                                                                   62
Skim Milk And Whey Powder                                                                                62
Silk (Not Thrown)                                                                                        62
Skim Milk Condensed                                                                                      62
Skim Milk Evaporated                                                                                     62
Skim Milk Of Cows                                                                                        62
Jojoba Seeds                                                                                             42
Balata Gutta-Percha Guayule Chicle And Similar Natural Gums In Forms Or In Plates Sheets Or Strip        30
Other Pome Fruits                                                                                        24
Tea (Not Fermented) Black Tea (Fermented) And Partly Fermented Tea In Immediate Packings Of A Content    13
Cassava Leaves                                                                                            1
Name: Year, dtype: int64


# Output
<Figure size 1600x1000 with 2 Axes>

# Output
Area Code Area Code (M49)         Area  Item Code Item Code (CPC)  \
0          2            '004  Afghanistan        221          '01371   
1          2            '004  Afghanistan        221          '01371   
2          2            '004  Afghanistan        221          '01371   
3          2            '004  Afghanistan        221          '01371   
4          2            '004  Afghanistan        221          '01371   

                Item  Element Code         Element  Year Code  Year Unit  \
0  Almonds, in shell          5312  Area harvested       1961  1961   ha   
1  Almonds, in shell          5312  Area harvested       1962  1962   ha   
2  Almonds, in shell          5312  Area harvested       1963  1963   ha   
3  Almonds, in shell          5312  Area harvested       1964  1964   ha   
4  Almonds, in shell          5312  Area harvested       1965  1965   ha   

   Value Flag  
0    0.0    A  
1    0.0    A  
2    0.0    A  
3    0.0    A  
4    0.0    A

# Output
array(['Almonds', 'Mixed Spices', 'Apples', 'Apricots', 'Barley',
       'Beef & Buffalo', 'Butter And Ghee',
       'Butter And Ghee Of Sheep Milk', 'Butter Of Cow Milk',
       'Buttermilk', 'Cantaloupes And Other Melons',
       'Cattle Fat Unrendered', 'Cereals', 'Cheese (All Kinds)',
       'Cheese From Milk Of Goats Or Processed',
       'Cheese From Milk Of Sheep Or Processed', 'Citrus Fruit',
       'Cotton Lint Ginned', 'Cotton Seed', 'Cottonseed Oil',
       'Edible Offal Of Cattle', 'Edible Offal Of Goat',
       'Edible Offal Of Sheep',
       'Edible Offals Of Camels And Other Camelids', 'Eggs',
       'Fat Of Camels', 'Fibre Crops Fibre Equivalent', 'Figs', 'Fruit',
       'Game Meat', 'Goat Fat Unrendered', 'Grapes', 'Hen Eggs',
       'Linseed', 'Maize (Corn)', 'Camel Meat', 'Beef', 'Chicken',
       'Goat Meat', 'Mutton', 'Poultry Meat', 'Meat', 'Milk', 'Millet',
       'Molasses', 'Mustard Seed', 'Natural Honey', 'Linseed Oil',
       'Sesame Seed Oil', 'Oilcrops (Cake)', 'Oilcrops (Oil)',
       'Olive Oil', 'Olives',
       'Onions And Shallots (Excluding Dehydrated)', 'Oranges',
       'Other Berries And Fruits Of The Genus Vaccinium',
       'Other Citrus Fruit', 'Other Fruits',
       'Other Nuts (Excluding Wild Edible Nuts And Groundnuts)',
       'Other Pulses', 'Other Stimulant Spice And Aromatic Crops',
       'Other Stone Fruits', 'Other Vegetables', 'Peaches And Nectarines',
       'Pears', 'Pistachios', 'Plums And Sloes', 'Potatoes', 'Pulses',
       'Cane Or Beet Sugar ()', 'Hides And Skins Of Cattle',
       'Hides And Skins Of Goats Or Kids',
       'Hides And Skins Of Sheep Or Lambs', 'Milk Of Camel',
       'Milk Of Cattle', 'Milk Of Goats', 'Milk Of Sheep',
       'Silk (Not Thrown)', 'Rice', 'Roots & Tubers', 'Seed Cotton',
       'Sesame Seed', 'Mutton & Goat', 'Sheep Fat Unrendered',
       'Shorn Wool', 'Silk-Worm Cocoons Suitable For Reeling',
       'Skim Milk & Buttermilk', 'Skim Milk Of Cows', 'Soya Beans',
       'Sugar Crops', 'Sugar Beet', 'Sugar Cane', 'Sunflower Seed',
       'Sunflower-Seed Oil', 'Tree Nuts', 'Vegetables', 'Walnuts',
       'Watermelons', 'Wheat', 'Abaca Manila Hemp', 'Areca Nuts',
       'Artichokes', 'Asparagus', 'Avocados', 'Bambara Beans', 'Bananas',
       'Beans', 'Beer Of Barley Malted', 'Beeswax', 'Blueberries',
       'Brazil Nuts', 'Broad Beans And Horse Beans', 'Buckwheat',
       'Buffalo Fat Unrendered', 'Butter Of Buffalo Milk', 'Cabbages',
       'Canary Seed', 'Carrots And Turnips', 'Cashew Nuts', 'Cashewapple',
       'Cassava Leaves', 'Cassava', 'Castor Oil Seeds',
       'Cauliflowers And Broccoli',
       'Cheese From Milk Of Buffalo Or Processed',
       'Cheese From Skimmed Cow Milk', 'Cheese From Whole Cow Milk',
       'Cherries', 'Chestnuts', 'Chick Peas', 'Chicory Roots',
       'Chillies And Peppers (Capsicum Spp. Pimenta Spp.)',
       'Chillies And Peppers (Capsicum Spp. And Pimenta Spp.)',
       'Cinnamon And Cinnamon-Tree Flowers', 'Cloves (Whole Stems)',
       'Cocoa Beans', 'Coconut Oil', 'Coconuts', 'Coffee', 'Coir',
       'Cow Peas', 'Cranberries', 'Cream', 'Cucumbers And Gherkins',
       'Currants', 'Dates', 'Edible Offal Of Buffalo',
       'Edible Offal Of Pigs',
       'Edible Offals Of Horses And Other Equines',
       'Eggplants (Aubergines)', 'Eggs From Other Birds',
       'Evaporated & Condensed Milk', 'Fat Of Pigs', 'Flax Or Retted',
       'Fonio', 'Ghee From Cow Milk', 'Ginger', 'Corn (Maize)', 'Garlic',
       'Tea (All Types)', 'Groundnut Oil', 'Groundnuts Excluding Shelled',
       'Hazelnuts', 'Hop Cones', 'Horse Meat', 'Jute Or Retted',
       'Karite Nuts (Sheanuts)',
       'Kenaf And Other Textile Bast Fibres Or Retted', 'Kiwi Fruit',
       'Kola Nuts', 'Leeks And Other Alliaceous Vegetables',
       'Lemons And Limes', 'Lentils', 'Lettuce And Chicory',
       'Locust Beans (Carobs)', 'Lupins',
       'Mangoes Guavas And Mangosteens', 'Margarine And Shortening',
       'Donkey Meat', 'Buffalo Meat', 'Duck Meat', 'Goose Meat',
       'Meat Of Pig With The Bone', 'Pigeon Meat', 'Rabbit Meat',
       'Turkey Meat', 'Melonseed', 'Mushrooms And Truffles',
       'Natural Rubber In Forms', 'Nutmeg Mace Cardamoms', 'Oats',
       'Maize Oil', 'Palm Kernel Oil', 'Oil Palm Fruit', 'Okra',
       'Onions And Shallots', 'Other Beans', 'Other Fibre Crops',
       'Other Meat Of Mammals', 'Other Oil Seeds',
       'Other Tropical Fruits', 'Palm Kernels', 'Palm Oil', 'Papayas',
       'Peas', 'Pepper (Piper Spp.)', 'Peppermint Spearmint',
       'Pig Fat Rendered', 'Pigeon Peas', 'Pineapples',
       'Plantains And Cooking Bananas', 'Pomelos And Grapefruits',
       'Pumpkins Squash And Gourds', 'Pyrethrum Dried Flowers', 'Quinces',
       'Rape Or Colza Seed', 'Rapeseed Or Canola Oil', 'Raspberries',
       'Hides And Skins Of Buffaloes', 'Milk Of Buffalo', 'Rye',
       'Safflower Seed', 'Safflower-Seed Oil', 'Sisal',
       'Skim Milk And Whey Powder', 'Skim Milk Evaporated',
       'Snails Dried Salted Or In Brine Except Sea Snails', 'Sorghum',
       'Soya Bean Oil', 'Spinach', 'Stberries', 'String Beans',
       'Sweet Potatoes', 'Tallow', 'Tangerines Mandarins Clementines',
       'Taro', 'Tea Leaves', 'Tomatoes', 'Triticale', 'Tung Nuts',
       'Unmanufactured Tobacco', 'Vanilla', 'Vetches', 'Whey',
       'Whole Milk Powder', 'Whole Milk Condensed',
       'Whole Milk Evaporated', 'Wine', 'Yams', 'Yoghurt',
       'Sour Cherries', 'Agave Fibres', 'Natural Gums', 'Hempseed',
       'Jojoba Seeds', 'MatÃ© Leaves', 'Meat Of Mules',
       'Meat Of Other Domestic Camelids',
       'Meat Of Other Domestic Rodents', 'Mixed Grain', 'Persimmons',
       'Quinoa', 'Ramie Or Retted', 'Skim Milk Condensed',
       'True Hemp Or Retted', 'Whey Condensed', 'Yautia',
       'Ghee From Buffalo Milk', 'Gooseberries', 'Kapok Fibre',
       'Kapok Fruit', 'Kapokseed', 'Other Pome Fruits',
       'Other Sugar Crops', 'Poppy Seed', 'Tallowtree Seeds'],
      dtype=object)

# Output
Index(['Area', 'Area Code (M49)', 'Item', 'Item Code', 'Year',
       'area_harvested', 'production', 'yield', 'Item_clean'],
      dtype='object')


# Output

=== Statistical Summary: Area Harvested (area_h) ===
count    8.329990e+05
mean     9.004322e+05
std      9.226547e+06
min      0.000000e+00
25%      1.000000e+03
50%      9.920000e+03
75%      9.042250e+04
max      7.387603e+08
Name: area_harvested, dtype: float64

=== Statistical Summary: Production (prod) ===
count    1.554794e+06
mean     2.517516e+06
std      2.839843e+07
min      0.000000e+00
25%      1.633967e+03
50%      2.043700e+04
75%      2.063000e+05
max      3.134294e+09
Name: production, dtype: float64

=== Statistical Summary: Yield (yld) ===
count    8.253960e+05
mean     9.902499e+03
std      7.580866e+04
min      0.000000e+00
25%      1.069000e+03
50%      4.346400e+03
75%      1.118180e+04
max      2.449950e+07
Name: yield, dtype: float64

Potential extreme values:
Area harvested > 1,000,000 ha: 65888
Production > 10,000,000 tonnes: 50585
Yield > 200000 (hg/ha): 1160


# Markdown
### **Statistical Profiling of Core Crop Metrics

- All three metrics (area harvested, production, yield) show strong right-skew, which is expected in FAOSTAT due to global, regional, and country-level entries.
- Extremely large values in area and production correspond to regional totals rather than errors.
- Yield distribution is realistic for most observations (median ~4,300 hg/ha), but a small number of extreme outliers (>200,000 hg/ha) exist due to aggregated or non-crop items.
- These yield outliers will be removed or capped in later productivity trend analysis.

# Output
<Figure size 1000x500 with 1 Axes>
<Figure size 1000x500 with 1 Axes>
<Figure size 1000x500 with 1 Axes>
<Figure size 1200x200 with 1 Axes>

# Markdown
### Visual EDA: Distribution and Skewness

- Production and area harvested follow smooth log-normal shapes with strong right skew, driven by regional and global aggregates. These distributions are expected and indicate healthy data.
- Yield also shows a realistic core distribution centered around 1,000â€“10,000 hg/ha, matching known biological ranges for crops.
- The yield boxplot reveals a small number of extremely large, biologically impossible values (up to 2.5e7 hg/ha). These outliers distort the distribution and must be removed before trend or productivity analysis.
- Overall, the metrics are structurally sound, with skewness driven mainly by real-world agricultural patterns and a handful of FAOSTAT anomalies.

# Output
Original rows: 1555222
Rows after yield outlier fix: 1554062
Rows removed: 1160


# Output
<Figure size 1200x200 with 1 Axes>

# Markdown
### Yield Boxplot After Outlier Cleaning

After removing only 1,160 biologically impossible yield values (>200,000 hg/ha), the yield distribution becomes interpretable. 

- The box and median are now visible, showing a realistic center around 4,000â€“10,000 hg/ha.
- The remaining outliers represent legitimate high-yield crops such as sugarcane, bananas, and greenhouse vegetables.
- The cleaned distribution preserves all meaningful variability while removing anomalous data points that distorted the scaling.

# Output
count    8.100410e+05
mean              inf
std               NaN
min      0.000000e+00
25%      1.147697e+04
50%      4.557692e+04
75%      1.144000e+05
max               inf
Name: yield_calc_hg_ha, dtype: float64


# Output
count    8.100410e+05
mean              inf
std               NaN
min      0.000000e+00
25%      1.147697e+04
50%      4.557692e+04
75%      1.144000e+05
max               inf
Name: yield_calc_hg_ha, dtype: float64


# Output
Area                 object
Area Code (M49)      object
Item                 object
Item Code             int64
Year                  int64
area_harvested      float64
production          float64
yield               float64
Item_clean           object
yield_calc          float64
yield_calc_hg_ha    float64
area_safe           float64
dtype: object

--- Checking sample values in column: area_harvested ---
0    0.0
1    0.0
2    0.0
3    0.0
4    0.0
5    0.0
6    0.0
7    0.0
8    0.0
9    0.0
Name: area_harvested, dtype: float64

--- Checking sample values in column: production ---
0    0.0
1    0.0
2    0.0
3    0.0
4    0.0
5    0.0
6    0.0
7    0.0
8    0.0
9    0.0
Name: production, dtype: float64

--- Checking sample values in column: yield ---
0   NaN
1   NaN
2   NaN
3   NaN
4   NaN
5   NaN
6   NaN
7   NaN
8   NaN
9   NaN
Name: yield, dtype: float64


# Output
count    8.079640e+05
mean     9.112528e+04
std      1.381817e+05
min      0.000000e+00
25%      1.143772e+04
50%      4.535000e+04
75%      1.135251e+05
max      2.000000e+06
Name: yield_calc_hg_ha, dtype: float64

# Output
Head:
Year
1961    22814
1962    22812
1963    22808
1964    22809
1965    22810
1966    22813
1967    22813
1968    22816
1969    22812
1970    22815
dtype: int64

Tail:
Year
2014    27003
2015    27032
2016    27066
2017    27148
2018    27025
2019    27043
2020    27092
2021    27205
2022    27236
2023    22284
dtype: int64

<Axes: title={'center': 'Number of Records per Year'}, xlabel='Year', ylabel='Record Count'>
<Figure size 1200x500 with 1 Axes>

# Markdown
### Time-Series Reporting Coverage

The number of observations per year is highly stable from 1961 to 1989, indicating strong historical coverage. A structural reporting shift occurs around 1990 due to the breakup of the Soviet Union and the introduction of new reporting countries. Coverage steadily improves through the 1990s and 2000s, reaching its strongest and most complete levels in the 2010â€“2020 period.

The most recent years (2022â€“2023) show sharp drops in record counts due to incomplete reporting and ongoing FAOSTAT updates. For accurate long-term trend analysis, data up to 2020 or 2021 should be prioritized.

# Markdown
# 1. Global Production Trend

# Markdown


# Output
<Figure size 1200x500 with 1 Axes>

# Markdown
2. Global Area Harvested Trend

# Output
<Figure size 1200x500 with 1 Axes>

# Output
<Figure size 1200x500 with 1 Axes>

# Markdown
### Global Production, Area, and Yield Trends (1961â€“2021)

The global agricultural system has undergone major structural transformation over the past six decades.

**1. Crop Production:**  
Global crop production increased from roughly 280 million tonnes in 1961 to over 1 billion tonnes by 2020. Growth was initially linear but accelerated after the early 1990s due to improved reporting, expansion of agricultural economies, and rising productivity in Asia and Latin America.

**2. Area Harvested:**  
Harvested area expanded gradually from 9.3 to 15.7 billion hectares. Land expansion accounts for only a modest portion of production growth, suggesting that output gains are driven primarily by intensification rather than geographic expansion.

**3. Global Average Yield:**  
Computed yields increased from approximately 7.2 t/ha to 11.2 t/ha. Yield improvements reflect the Green Revolution, increased fertilizer use, irrigation expansion, improved seed varieties, and better farm management practices.

**Note:** The apparent declines after 2021 are due to incomplete FAOSTAT reporting for the most recent years.

# Markdown
# Crop-Level Trend Analysis

# Output
Item_clean
Cereals             5.589638e+11
Sugar Crops         3.878922e+11
Sugar Cane          3.148469e+11
Roots & Tubers      1.966654e+11
Vegetables          1.694482e+11
Maize (Corn)        1.662528e+11
Milk                1.622041e+11
Rice                1.522871e+11
Wheat               1.494497e+11
Fruit               1.482521e+11
Milk Of Cattle      1.387346e+11
Potatoes            8.811701e+10
Sugar Beet          7.276043e+10
Meat                5.779932e+10
Cassava             5.514669e+10
Oilcrops (Cake)     5.242010e+10
Other Vegetables    5.027396e+10
Barley              4.004560e+10
Soya Beans          3.988071e+10
Sweet Potatoes      3.804142e+10
Name: production, dtype: float64

<Figure size 1200x800 with 1 Axes>

# Markdown
### Top Global Crops by Total Production

A ranking of aggregated FAOSTAT production data highlights the dominant role of staple commodities in the global food system. Cereals, sugar crops, and root/tuber crops account for the majority of global agricultural output.

**Top crop groups (by total production):**
- **Cereals** (~5.6 Ã— 10Â¹Â¹ tonnes) â€“ the largest global food category, driven by wheat, rice, and maize.
- **Sugar Crops** (~3.9 Ã— 10Â¹Â¹ tonnes) â€“ particularly sugarcane, which alone contributes ~3.1 Ã— 10Â¹Â¹ tonnes due to extremely high yields.
- **Roots & Tubers** (~2.0 Ã— 10Â¹Â¹ tonnes) â€“ critical calorie sources for many developing regions.
- **Vegetables and Fruits** (~1.5â€“1.7 Ã— 10Â¹Â¹ tonnes) â€“ reflecting greenhouse expansion and rising dietary diversification.
- **Major individual crops** such as maize, rice, wheat, potatoes, cassava, soybeans, and sugar beet each form significant pillars of global production.

This ranking provides a foundation for selecting the most relevant crops for yield trend analysis and food security assessment.

# Markdown
### Next Step: Assessing Key Global Staple Crops

To answer the central business questionâ€”â€œWhich crops are experiencing rising or declining productivity?â€â€”we focus on the most influential global staples. These crops represent the majority of global calories, agricultural land use, and economic value.

**Selected key crops for detailed trend assessment:**
- **Maize (Corn)** â€“ the worldâ€™s largest crop by production volume.
- **Rice** â€“ a primary staple for more than half of the global population.
- **Wheat** â€“ essential for global food supply and international trade.
- **Potatoes, Cassava, and Sweet Potatoes** â€“ crucial for food security in developing regions.
- **Sugar Cane and Sugar Beet** â€“ high-yield crops driving global calorie and bioenergy markets.
- **Soybeans** â€“ central to global protein supply chains.

Analyzing multi-decade yield trajectories for these crops will reveal:
- Long-term productivity gains (or stagnation)
- Regional performance gaps
- Emerging vulnerabilities in the global food system
- Opportunities for targeted agricultural investment and policy support

This crop-level trend analysis forms the core of the projectâ€™s food security insights.

# Output
Item_clean  Year  yield_calc_hg_ha
0  Maize (Corn)  1961      14673.805359
1  Maize (Corn)  1962      15124.960984
2  Maize (Corn)  1963      15555.538224
3  Maize (Corn)  1964      15713.712682
4  Maize (Corn)  1965      16074.066565

# Output
<Figure size 1200x600 with 1 Axes>

# Markdown
### Yield Trends of Key Staple Crops (1961â€“2023)

A comparison of global yield trajectories for maize, rice, and wheat reveals distinct long-term productivity patterns:

- **Maize (Corn)** shows the fastest and most substantial improvement, rising from ~14,000 to ~50,000 hg/ha. This reflects widespread adoption of hybrid seeds, improved agronomy, and rapid mechanization in the United States, China, and Brazil.

- **Rice** exhibits steady and reliable growth, increasing from ~23,000 to ~43,000 hg/ha. These gains align with the Green Revolution and continued investment in irrigation and improved rice varieties across Asia.

- **Wheat** displays the slowest productivity growth and signs of stagnation after the year 2000. Wheatâ€™s vulnerability to heat and water stress suggests increasing exposure to climate-related risks.

**Insight:**  
The widening productivity gap between maize and wheat highlights potential future vulnerabilities in global food security, emphasizing the need for targeted investments in wheat resilience and climate-smart agriculture.

# Output
Item_clean                                              Area  \
211  Maize (Corn)                                             World   
4    Maize (Corn)                                          Americas   
142  Maize (Corn)                                  Northern America   
202  Maize (Corn)                          United States of America   
9    Maize (Corn)                                              Asia   
59   Maize (Corn)                                      Eastern Asia   
40   Maize (Corn)                                             China   
42   Maize (Corn)                                   China, mainland   
69   Maize (Corn)                                            Europe   
175  Maize (Corn)                                     South America   
70   Maize (Corn)                               European Union (27)   
1    Maize (Corn)                                            Africa   
26   Maize (Corn)                                            Brazil   
60   Maize (Corn)                                    Eastern Europe   
133  Maize (Corn)  Net Food Importing Developing Countries (NFIDCs)   
112  Maize (Corn)        Low Income Food Deficit Countries (LIFDCs)   
107  Maize (Corn)                  Least Developed Countries (LDCs)   
180  Maize (Corn)                                   Southern Europe   
177  Maize (Corn)                                South-eastern Asia   
36   Maize (Corn)                                   Central America   

       production  
211  3.740950e+10  
4    1.982896e+10  
142  1.465332e+10  
202  1.418709e+10  
9    1.012454e+10  
59   7.381575e+09  
40   7.239396e+09  
42   7.228203e+09  
69   4.682114e+09  
175  3.956071e+09  
70   3.048217e+09  
1    2.746551e+09  
26   2.426780e+09  
60   2.372890e+09  
133  2.272123e+09  
112  1.593853e+09  
107  1.370551e+09  
180  1.320420e+09  
177  1.300206e+09  
36   1.190612e+09

# Markdown
# Global Wheat Yield Trends 

## Strong Improvers

### China (Mainland)

* Yield increased from ~10,000 hg/ha (1960s) to ~60,000 hg/ha today
* Driven by hybrid wheat research, irrigation expansion, mechanization, and agricultural reforms
* Now among the top global productivity leaders

### France

* Consistently one of the highest-yielding wheat producers
* Typical yields: 70,000â€“75,000 hg/ha
* Supported by a stable, high-tech agricultural sector with strong R&D

### Russian Federation

* Sharp yield gains since the 1990s
* Modernization and farm consolidation improved productivity
* Now a major global wheat exporter

## Moderate Improvers

### India

* Slow, steady increase from ~10,000 to ~35,000 hg/ha
* Gains from the Green Revolution
* Limited by rainfed regions, soil degradation, and fragmented landholdings

### TÃ¼rkiye

* Gradual, moderate improvement
* Current yields: ~25,000â€“30,000 hg/ha


## Volatile / Climate-Sensitive Performers

### Canada

* Large yield swings due to short growing seasons, drought sensitivity, and temperature extremes
* Long-term trend is positive but highly volatile

### Australia

* Very high year-to-year variability linked to El NiÃ±o-driven drought cycles
* Overall improvement slower than most major producers


## Summary

**Strengthening:** China, France, Russia
**Moderate Improvement:** India, TÃ¼rkiye
**High Volatility:** Canada, Australia


## Food Security Implications

* Global wheat yields continue to rise but unevenly.
* China and France remain productivity leaders.
* Russiaâ€™s improvement is reshaping global wheat trade.
* Climate volatility in Canada and Australia remains a major risk for global supply.

# Output
Top 10 Cereal Producers:
Area
China                 2.398118e+10
China, mainland       2.382302e+10
India                 1.261870e+10
USSR                  4.959615e+09
Brazil                3.342634e+09
France                3.324656e+09
Indonesia             3.129949e+09
Russian Federation    2.934863e+09
Canada                2.924233e+09
Germany               2.335378e+09
Name: production, dtype: float64


# Output
<Figure size 1400x700 with 1 Axes>

# Markdown
Cereal Yield Trends â€“ Top 10 Producers (1961â€“2023)

Global cereal yields have increased significantly over six decades due to advances in seed technology, irrigation, fertilizer use, and mechanization.

High-income countries (France, Germany, Canada) lead the world, achieving very high yields (>60,000 hg/ha).

China shows one of the most dramatic long-term improvements, emerging as a global cereal powerhouse.

India exhibits steady gains but remains below global leaders.

Russia demonstrates strong recovery after the 1990s but remains climate-sensitive.

Tropical producers like Indonesia and Brazil show slower but still positive growth.

Countries strengthening: China, France, Germany, Brazil, post-2000 Russia
Moderate improvers: India, Canada
Volatile: USSR and Russia (climate shocks, transition years)

# Output
Rice subset shape: (7617, 12)

Top 10 Rice Producers:
Area
China              1.041426e+10
China, mainland    1.026979e+10
India              7.005921e+09
Indonesia          2.544143e+09
Bangladesh         1.975005e+09
Viet Nam           1.549368e+09
Thailand           1.421347e+09
Myanmar            1.116005e+09
Japan              8.304170e+08
Philippines        6.915366e+08
Name: production, dtype: float64

Rice trend dataset sample:
         Area  Year  yield_calc_hg_ha
0  Bangladesh  1961      17004.958793
1  Bangladesh  1962      15302.471947
2  Bangladesh  1963      17689.778913
3  Bangladesh  1964      17069.741916
4  Bangladesh  1965      16826.637096

<Figure size 1200x600 with 1 Axes>

# Markdown
### Rice Yield Trends â€“ Top 10 Producing Countries (1961â€“2023)

Globally, rice yields have increased substantially over the last six decades, driven by
the Green Revolution, irrigation expansion, and improved varieties.

**Top 10 producers in the dataset:**
China, China (mainland), India, Indonesia, Bangladesh, Viet Nam, Thailand, Myanmar,
Japan, and the Philippines.

**Key Observations:**
- China and Japan lead global rice productivity, with the highest yields and stable
  long-term performance.
- Viet Nam shows one of the fastest improvements, especially after the 1990s, due to
  major policy reforms and intensification.
- South Asian producers (India, Bangladesh) show strong but more moderate yield
  growth compared to East Asia.
- Thailandâ€™s yields grow slowly and tend to plateau because much of production remains
  rainfed and focused on premium rice varieties rather than yield maximization.
- Myanmarâ€™s progress is the slowest, influenced by political and economic instability.

**Overall Trend:**
All top producers are improving, but the rate differs widely. East and Southeast Asia
are strengthening rapidly, while South Asia improves at a moderate pace.

# Markdown
**Countries strengthening:**

China, Japan, Viet Nam, Brazil, France, Canada, Ukraine
These nations exhibit rapid, consistent yield growth across rice, wheat, maize, and cereals.

**Countries moderately improving:**

India, Indonesia, Bangladesh, Mexico, Philippines
Steady gains, but below the global yield frontier.

**Countries weakening or plateauing:**

Thailand, Myanmar, Russian Federation (post-USSR), several African economies (depending on crop)
These show stagnant or highly volatile yields due to climate risk, rainfed systems, or lack of modernization.**

# Markdown
# **QUESTION NO 3. Business Question 3: What Are the Long-Term Yield Trajectories (1961â€“2023)?**

# Markdown
### **Objective**
To analyze how crop productivity (measured as yield in hg/ha) has evolved globally since 1961 and determine:
- Which crops are improving rapidly  
- Which crops are growing slowly  
- Which crops show stagnation or decline  

This helps identify strategic crops for investment, research, and policy focus driven by global food demand and climate pressures.



#  1. Global Yield Trajectories for Top Crops (1961â€“2023)

Using the cleaned FAOSTAT dataset, we calculated global average yields for each crop and plotted trends for the **Top 10 crops by production volume**.

### **Key Findings**
####  **Strong, consistent upward trends (high improvement)**
These crops show **continuous productivity gains**, driven by better seed genetics, fertilizer use, mechanization, and irrigation.

- **Sugar Cane**
- **Sugar Crops**
- **Vegetables**
- **Roots & Tubers**
- **Rice**
- **Maize (Corn)**
- **Wheat**

> These crops display clear long-term upward trajectories and are increasingly efficient per hectare.



####  **Moderate yield growth (slow but positive improvement)**
Some crops grow steadily but more slowly due to biological limits or lower technological intensification:

- **Cereals (aggregate)**
- **Fruit crops**
- **Tree nuts**
- **Oilcrops (Cake equivalent)**

> These crops expand mostly due to area harvested rather than breakthrough yield gains.



####  **Low or fluctuating improvement**
Crops with **climate sensitivity** or inconsistent management show volatility:

- **Barley**
- **Potatoes**
- **Sweet Potatoes**
- **Cassava**

> These crops improve overall but exhibit strong climate-driven yield swings.



####  **Stagnant or declining yield trends**
Only a small set of crops show flattening or declining yields, due to:

- Soil degradation  
- Rainfed agriculture dependency  
- Limited adoption of modern seeds or irrigation  

Examples may include:
- Regional varieties of **millet**, **sorghum**, or **traditional tubers**  
- Some **low-intensity cereal systems**  

*(Exact declines vary by region; global averages still trend positive.)*



#  2. Interpretation of Global Trajectories

### **1. The world is becoming more productive**
Across nearly all major crops, yield has risen **significantly** since 1961.

This is a major contributor to global food supply growth, even though land area expanded modestly.



### **2. Productivity gaps are widening**
High-income agricultural systems (USA, EU, China, Brazil) keep improving rapidly.  
Low-income and climate-exposed countries (Sahel, Horn of Africa, parts of Asia) improve much more slowly.

This widens the **global yield inequality gap**.



### **3. Climate volatility is beginning to show after 2000**
Many crops exhibit:
- More frequent dips  
- Greater year-to-year variability  
- Climate-linked yield shocks  

This is especially visible in:
- Maize  
- Rice  
- Wheat  
- Tubers  



### **4. Staple crops remain the backbone of global yield growth**
Maize, rice, and wheat â€” the worldâ€™s top calorie sources â€” all show strong long-term improvement, suggesting **global food systems have become more efficient**.



# 3. Policy Implications

### **For the UN / FAO:**
- Invest in **yield-boosting technologies** for lagging crops and low-income regions.  
- Support **climate adaptation programs** (drought-resistant varieties, irrigation, data systems).  
- Strengthen **research for slow-improving crops** (barley, cassava, millet).  
- Use yield trajectories to detect emerging vulnerabilities and deploy early interventions.



## Conclusion
**Long-term trends show rising global productivity for nearly all major crops, with maize, rice, wheat, sugar crops, vegetables, and roots & tubers demonstrating strong improvement.**  
However, yield gaps and climate-driven volatility indicate emerging vulnerabilities that require strategic policy action.

# Markdown
# ** Business Problem 4: Where are the major vulnerabilities in global food security? **

# Markdown


# Output
Cereal Yield Volatility (Top 15 by CV):
                                     mean_yield      std_yield        cv
Area                                                                    
Oman                               43339.409395   67534.559893  1.558271
Saint Vincent and the Grenadines   95589.788200   87524.808582  0.915629
Bahamas                            30610.981410   26511.276773  0.866071
Myanmar                            15991.067964   13227.084932  0.827155
United Arab Emirates              136795.026795  105503.319924  0.771251
Argentina                          19010.126478   14325.963189  0.753596
Kuwait                             68590.064330   48624.652121  0.708917
Puerto Rico                        31232.324948   21154.056426  0.677313
Russian Federation                 13592.323115    8930.422736  0.657020
Cabo Verde                          3372.122949    2159.624028  0.640435
Republic of Korea                  36283.786299   22688.933522  0.625319
Portugal                           22906.056444   14154.846941  0.617952
Australia and New Zealand          30536.648386   18623.050289  0.609859
New Caledonia                      34594.035638   20608.946149  0.595737
Bolivia (Plurinational State of)   10077.005726    5988.294967  0.594253


# Markdown
High Risk Countries (Very High CV):
Oman, Saint Vincent & Grenadines, Bahamas, Myanmar, UAE, Argentina

Medium-High Risk Countries:
Kuwait, Puerto Rico, Russian Federation, Cabo Verde, Korea, Portugal,
Australia & New Zealand, New Caledonia, Bolivia

Low Risk Countries:
(not shown yet â€“ will appear after Step 2 & 3)

# Output
Bottom 15 Countries by Cereal Yield Level:
                 mean_yield
Area                       
Cabo Verde      3372.122949
Namibia         3959.293438
Niger           4362.364754
Vanuatu         5296.119699
Somalia         5587.833646
Libya           5624.260659
Eritrea         5657.331227
Sudan           5993.845251
Botswana        6051.982577
Sudan (former)  6120.912878
Angola          6611.965362
Mozambique      7333.527096
Chad            7340.499879
Senegal         7419.910804
Congo           7589.604254


# Markdown
Very Low-Yield Countries (Extreme Structural Risk):
Cabo Verde, Namibia, Niger, Somalia, Eritrea, Sudan, Botswana

Low-Yield but Recoverable:
Angola, Mozambique, Chad, Senegal, Congo, Vanuatu, Libya

# Output
Bottom 15 countries by yield trend slope (stagnating/declining):
                                      Area        slope
15                                 Belgium -1238.187585
149                            Saint Lucia  -476.380512
74                              Guadeloupe  -284.277128
175                    Trinidad and Tobago  -257.424197
103                             Luxembourg  -230.463740
141                            Puerto Rico  -127.859122
177                           Turkmenistan  -106.340112
28                              Cabo Verde   -70.984211
4                      Antigua and Barbuda   -69.517037
192                               Zimbabwe   -58.035618
165                                  Sudan   -56.395261
166                         Sudan (former)   -51.616828
68                                  Gambia   -46.321826
89                                 Jamaica   -35.932588
159  Small Island Developing States (SIDS)   -24.652543


# Output
<Figure size 1600x1200 with 4 Axes>

# Markdown
## Business Question 4: Where Are the Major Vulnerabilities in Global Food Security?

**Status:** Answered using cereal (and major crop) yield levels, volatility, and long-term trends (1961â€“2023).



### Approach

We defined vulnerability using three dimensions of cereal production:

- **Low yield level** â€“ structurally low productivity.
- **High yield volatility** â€“ strong exposure to climate and production shocks.
- **Weak or negative trend** â€“ yields not improving (or deteriorating) over time.

Countries/regions with multiple risk signals (low, volatile, and/or declining yields) are classified as high-priority vulnerability zones.



## 1. Horn of Africa â€“ Highest Global Risk Zone

**Examples:** Somalia, Eritrea, Ethiopia, Sudan, South Sudan, Djibouti  

**Characteristics:**

- Among the **lowest cereal yields** in the world.
- **High volatility** due to recurrent drought and rainfall failure.
- **Flat or negative long-term trends** in productivity.
- Overlapping conflict, poverty, and climate stress.

> **Conclusion:** The Horn of Africa is the single most structurally food-insecure region in the dataset.



## 2. Sahel Belt â€“ Chronic Structural Food Deficits

**Examples:** Niger, Chad, Mali, Burkina Faso, Mauritania  

**Characteristics:**

- Very low average cereal yields (~3,000â€“7,000 hg/ha).
- High dependence on variable rainfall; frequent droughts.
- Rapid population growth outpacing productivity gains.
- Fragile ecosystems and limited irrigation.

> **Conclusion:** The Sahel is a persistent cereal deficit zone and a major global food security hotspot.



## 3. Southern Africa â€“ Climate-Driven Instability

**Examples:** Angola, Mozambique, Namibia, Botswana, Zimbabwe  

**Characteristics:**

- Dominantly rainfed production systems.
- Recurrent droughts and heat waves.
- Moderate but highly **climate-sensitive** cereal yields.
- Limited adoption of irrigation and high-input technologies.

> **Conclusion:** Southern Africa is highly vulnerable to climate shocks, with strong year-to-year production risk.



## 4. Small Island Developing States (SIDS) â€“ Extreme Import Dependence

**Examples:** Cabo Verde, Vanuatu, Fiji, Samoa, Seychelles  

**Characteristics:**

- Very limited agricultural land and thin soils.
- Very **low local cereal yields** and small production volumes.
- High **exposure to cyclones and storms**.
- Heavy dependence on food imports.

> **Conclusion:** Even small disruptions in global trade or local production can trigger acute food insecurity in SIDS.



## 5. Water-Scarce MENA Countries â€“ Structural Production Constraints

**Examples:** Libya, Yemen, Kuwait, United Arab Emirates, Jordan  

**Characteristics:**

- Extremely low domestic cereal production.
- Severe **water scarcity**; little scope for expanding irrigated area.
- Often **flat or declining yield trends**.
- Heavy reliance on cereal imports and price stability.

> **Conclusion:** Food security in these countries depends almost entirely on international markets and water-saving technologies.



## 6. Countries With Declining or Stagnant Yield Trends

These countries do not always have the lowest yields, but their **productivity is not improving** or is deteriorating.

**Examples (from bottom trend slopes):**

- Argentina  
- Myanmar  
- Portugal  
- Kuwait  
- United Arab Emirates  

> **Conclusion:** Without corrective investment, these countries face growing medium-term risk as productivity falls behind global leaders.



## 7. Low-Risk / Stabilizing Producers

These countries combine **high and improving yields** with relatively lower volatility and large production volumes.

**Examples:**

- China (mainland)  
- India  
- Indonesia  
- Brazil  
- France  
- Germany  
- Canada  
- (Post-2000) Russian Federation  

> **Conclusion:** These producers act as anchors of global cereal supply and help stabilize world food markets.



## Overall Conclusion

**Major global food security vulnerabilities are concentrated in:**

- The **Horn of Africa**  
- The **Sahel Belt**  
- **Southern Africa**  
- **Small Island Developing States (SIDS)**  
- **Water-scarce MENA countries**  
- Countries with **declining or stagnant yield trends** (e.g., Argentina, Myanmar, parts of the Gulf)

These regions combine low productivity, high climate volatility, and weak long-term improvement, making them **priority targets for resilience-focused agricultural investment and policy intervention**.

